<!doctype html>
<head>
</head>
<body>
    <script>
        customElements.define(
            "dalgona-block",
            class extends HTMLElement {
                constructor() {
                    super()
                    const template = document.getElementById("dalgona-block")
                    const content = template.content.cloneNode(true).querySelector("svg")
                    this.makeDraggable(content)
                    this.attachShadow({ mode: "open" })
                        .appendChild(content)
                }
                makeDraggable(target) {
                    console.log(target)
                    target.addEventListener("pointerdown", e => {
                        const {
                            e: initX,
                            f: initY,
                        } = target.transform.baseVal.getItem(0).matrix
                        const start = {
                            x: e.clientX - initX,
                            y: e.clientY - initY,
                        }
                        const onMove = e => {
                            target.transform.baseVal.getItem(0).setTranslate(
                                e.clientX - start.x,
                                e.clientY - start.y,
                            )
                        }
                        console.log(target)
                        document.body.addEventListener("pointermove", onMove)
                        document.body.addEventListener("pointerup", e => {
                            document.body.removeEventListener("pointermove", onMove)
                        }, { once: true })
                    })
                }
            }
        )
    </script>
    <template id="dalgona-block">
        <svg width="1000" height="1000" transform="translate(10 10)">
            <path
                d="
                    M0 0V10L5 15V11A1 1 0 016 10H12A1 1 0 0012 0H6A1 1 0 005 1V5L0 0Z
                "
                transform="
                    scale(10)
                "
                fill="#ffccdc"
                stroke="#fde"
                stroke-width="0.3"
            />
        </svg>
    </template>
    <dalgona-block id="a"/>
    <script>
    </script>
</body>